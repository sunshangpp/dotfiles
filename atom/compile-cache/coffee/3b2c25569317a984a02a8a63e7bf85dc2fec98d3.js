(function() {
  var $, BLANK_HASH, BlameLineComponent, HASH_LENGTH, RP, React, Reactionary, a, div, errorController, formatDate, getDefaultDate, moment, renderLoading, shell, span, _defaultDate;

  $ = require('atom-space-pen-views').$;

  React = require('react-atom-fork');

  Reactionary = require('reactionary-atom-fork');

  div = Reactionary.div, span = Reactionary.span, a = Reactionary.a;

  RP = React.PropTypes;

  moment = require('moment');

  formatDate = require('../util/blameFormatter').formatDate;

  errorController = require('../controllers/errorController');

  shell = require('shell');

  HASH_LENGTH = 7;

  BLANK_HASH = '-'.repeat(HASH_LENGTH);

  _defaultDate = null;

  getDefaultDate = function() {
    return _defaultDate != null ? _defaultDate : _defaultDate = formatDate(moment("2014-01-01T13:37:00 Z"));
  };

  renderLoading = function() {
    return div({
      className: 'blame-line loading'
    }, span({
      className: 'hash'
    }, BLANK_HASH), span({
      className: 'date'
    }, getDefaultDate()), span({
      className: 'committer'
    }, 'Loading'));
  };

  BlameLineComponent = React.createClass({
    propTypes: {
      date: RP.string.isRequired,
      hash: RP.string.isRequired,
      remoteRevision: RP.object,
      author: RP.string.isRequired,
      committer: RP.string.isRequired,
      committerDate: RP.string.isRequired,
      summary: RP.string.isRequired,
      backgroundClass: RP.string,
      noCommit: RP.bool,
      showOnlyLastNames: RP.bool.isRequired
    },
    render: function() {
      var url;
      if (this.props.noCommit) {
        return div({
          className: 'blame-line no-commit text-subtle'
        }, span({
          className: 'hash'
        }, BLANK_HASH), span({
          className: 'date'
        }, this.props.date), span({
          className: 'committer'
        }, 'Nobody'));
      } else {
        return div({
          className: 'blame-line ' + this.props.backgroundClass
        }, !this.props.remoteRevision ? a({
          onClick: this.didClickHashWithoutUrl,
          className: 'hash'
        }, this.props.hash.substring(0, HASH_LENGTH)) : (url = this.props.remoteRevision.url(this.props.hash), a({
          href: '#',
          'data-url': url,
          className: 'hash'
        }, this.props.hash.substring(0, HASH_LENGTH))), span({
          className: 'date'
        }, this.props.date), span({
          className: 'committer text-highlight'
        }, this.props.showOnlyLastNames ? this.props.author.split(' ').slice(-1)[0] : this.props.author));
      }
    },
    componentDidMount: function() {
      var $el;
      $el = $(this.getDOMNode());
      $('a', $el).click(this.didClickHashWithUrl);
      if (this.props.summary) {
        return atom.tooltips.add($el, {
          title: this.props.summary,
          placement: "auto left"
        });
      }
    },
    didClickHashWithUrl: function(e) {
      e.preventDefault();
      return shell.openExternal(e.target.getAttribute('data-url'));
    },
    componentWillUnmount: function() {
      var $el;
      $el = $(this.getDOMNode());
      if ($el.tooltip != null) {
        return $el.tooltip("destroy");
      }
    },
    shouldComponentUpdate: function(_arg) {
      var hash, showOnlyLastNames;
      hash = _arg.hash, showOnlyLastNames = _arg.showOnlyLastNames;
      return hash !== this.props.hash || showOnlyLastNames !== this.props.showOnlyLastNames;
    },
    didClickHashWithoutUrl: function(event, element) {
      return errorController.showError('error-no-custom-url-specified');
    }
  });

  module.exports = {
    BlameLineComponent: BlameLineComponent,
    renderLoading: renderLoading
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICIiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbCiAgICAiL1VzZXJzL3NzdW4vLmF0b20vcGFja2FnZXMvZ2l0LWJsYW1lL2xpYi92aWV3cy9ibGFtZS1saW5lLXZpZXcuY29mZmVlIgogIF0sCiAgIm5hbWVzIjogW10sCiAgIm1hcHBpbmdzIjogIkFBQUE7QUFBQSxNQUFBLDZLQUFBOztBQUFBLEVBQUMsSUFBSyxPQUFBLENBQVEsc0JBQVIsRUFBTCxDQUFELENBQUE7O0FBQUEsRUFDQSxLQUFBLEdBQVEsT0FBQSxDQUFRLGlCQUFSLENBRFIsQ0FBQTs7QUFBQSxFQUVBLFdBQUEsR0FBYyxPQUFBLENBQVEsdUJBQVIsQ0FGZCxDQUFBOztBQUFBLEVBR0Msa0JBQUEsR0FBRCxFQUFNLG1CQUFBLElBQU4sRUFBWSxnQkFBQSxDQUhaLENBQUE7O0FBQUEsRUFJQSxFQUFBLEdBQUssS0FBSyxDQUFDLFNBSlgsQ0FBQTs7QUFBQSxFQUtBLE1BQUEsR0FBUyxPQUFBLENBQVEsUUFBUixDQUxULENBQUE7O0FBQUEsRUFNQyxhQUFjLE9BQUEsQ0FBUSx3QkFBUixFQUFkLFVBTkQsQ0FBQTs7QUFBQSxFQU9BLGVBQUEsR0FBa0IsT0FBQSxDQUFRLGdDQUFSLENBUGxCLENBQUE7O0FBQUEsRUFRQSxLQUFBLEdBQVEsT0FBQSxDQUFRLE9BQVIsQ0FSUixDQUFBOztBQUFBLEVBVUEsV0FBQSxHQUFjLENBVmQsQ0FBQTs7QUFBQSxFQVdBLFVBQUEsR0FBYSxHQUFHLENBQUMsTUFBSixDQUFXLFdBQVgsQ0FYYixDQUFBOztBQUFBLEVBYUEsWUFBQSxHQUFlLElBYmYsQ0FBQTs7QUFBQSxFQWNBLGNBQUEsR0FBaUIsU0FBQSxHQUFBO2tDQUNmLGVBQUEsZUFBZ0IsVUFBQSxDQUFXLE1BQUEsQ0FBTyx1QkFBUCxDQUFYLEVBREQ7RUFBQSxDQWRqQixDQUFBOztBQUFBLEVBa0JBLGFBQUEsR0FBZ0IsU0FBQSxHQUFBO1dBQ2QsR0FBQSxDQUFJO0FBQUEs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

//# sourceURL=/Users/ssun/.atom/packages/git-blame/lib/views/blame-line-view.coffee
