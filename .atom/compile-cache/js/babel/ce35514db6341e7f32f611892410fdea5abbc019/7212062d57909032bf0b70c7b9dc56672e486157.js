'use babel';

/* eslint-disable no-use-before-define */

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.create = create;

function create(rawVariables) {
  var variables = {};

  function addVariable(parentPath, variable) {
    var path = pathJoin(parentPath, variable.path);
    var children = variable.children;

    variables[path] = {
      name: variable.name,
      loaded: true,
      hasChildren: children ? !!children.length : false,
      value: variable.value,
      parentPath: parentPath
    };
    if (children) {
      children.forEach(function (v) {
        addVariable(path, v);
      });
    }
  }

  rawVariables.map(function (variable) {
    var v = factory.variable(variable);
    v.path = v.name = variable.name;
    addVariable('', v);
  });

  return variables;
}

function pathJoin() {
  for (var _len = arguments.length, items = Array(_len), _key = 0; _key < _len; _key++) {
    items[_key] = arguments[_key];
  }

  return items.filter(function (i) {
    return i !== '';
  }).join('.');
}

var factory = {
  variable: function variable(_variable) {
    if (_variable.unreadable !== '') {
      return { value: '(unreadable ' + _variable.unreadable + ')' };
    }

    if (!_variable.value && _variable.addr === 0) {
      return { value: [shortType(_variable.type), nil()] };
    }

    var fn = KINDS[_variable.kind];
    if (fn.startsWith('complex')) {
      fn = 'complex';
    } else if (!factory[fn]) {
      fn = 'default';
    }
    return factory[fn](_variable);
  },
  array: function array(variable) {
    return factory.slice(variable);
  },
  slice: function slice(variable) {
    var children = variable.children.map(function (c, i) {
      var _factory$variable = factory.variable(c);

      var value = _factory$variable.value;
      var children = _factory$variable.children;

      return { path: i, name: formatNumber(i), value: value, children: children };
    });

    var diff = variable.len - variable.children.length;
    if (diff > 0) {
      children.push({ path: 'more', name: '... +' + diff + ' more' });
    }

    var kind = KINDS[variable.kind];
    var typeInfo = kind === 'slice' && ['(len: ', formatNumber(variable.len), ', cap: ', formatNumber(variable.cap), ')'];
    return {
      value: [shortType(variable.type), typeInfo],
      children: children
    };
  },
  ptr: function ptr(variable) {
    var child = variable.children[0];
    if (variable.type === '') {
      return { value: nil() };
    }

    if (child.onlyAddr) {
      return {
        value: ['(', shortType(variable.type), ')(', formatAddr(child), ')']
      };
    }

    var _factory$variable2 = factory.variable(child);

    var value = _factory$variable2.value;
    var children = _factory$variable2.children;

    return {
      value: ['*', value],
      children: children
    };
  },
  unsafePointer: function unsafePointer(variable) {
    return {
      value: ['unsafe.Pointer(', formatAddr(variable.children[0]), ')']
    };
  },
  string: function string(variable) {
    var diff = variable.len - variable.value.length;
    return {
      value: {
        className: 'string',
        value: ['"' + variable.value + '"', diff > 0 && '... +' + diff + ' more']
      }
    };
  },
  chan: function chan(variable) {
    // could also be rendered as struct
    // return factory.struct(variable)

    var content = undefined;
    if (variable.children.length === 0) {
      content = nil();
    } else {
      var c0 = factory.variable(variable.children[0]);
      var c1 = factory.variable(variable.children[1]);
      if (c0.children) {
        console.log(variable.children[0]);
      }
      if (c1.children) {
        console.log(variable.children[1]);
      }
      content = [c0.value, '/', c1.value];
    }
    return {
      value: [shortType(variable.type), content]
    };
  },
  struct: function struct(variable) {
    var type = shortType(variable.type);
    var diff = variable.len - variable.children.length;
    if (diff > 0) {
      return {
        value: [type && ['(*', type, ')'], '(', formatAddr(variable), ')']
      };
    }

    var children = variable.children.map(function (c) {
      var _factory$variable3 = factory.variable(c);

      var value = _factory$variable3.value;
      var children = _factory$variable3.children;

      return { path: c.name, name: c.name, value: value, children: children };
    });
    return {
      value: type,
      children: children
    };
  },
  'interface': function _interface(variable) {
    var child = variable.children[0];
    if (child.kind === 0 && child.addr === 0) {
      return {
        value: [shortType(variable.type), nil()]
      };
    }

    // nicer handling for errors
    if (variable.type === 'error' && child.type === '*struct errors.errorString') {
      return {
        value: ['error ', factory.variable(child.children[0].children[0]).value]
      };
    }

    var _factory$variable4 = factory.variable(child);

    var value = _factory$variable4.value;
    var children = _factory$variable4.children;

    return {
      value: [shortType(variable.type), ' (', value, ')'],
      children: children
    };
  },
  map: function map(variable) {
    var children = [];
    for (var i = 0; i < variable.children.length; i += 2) {
      var _factory$variable5 = factory.variable(variable.children[i]);

      var kv = _factory$variable5.value;
      var kc = _factory$variable5.children;

      var _factory$variable6 = factory.variable(variable.children[i + 1]);

      var vv = _factory$variable6.value;
      var vc = _factory$variable6.children;

      if (!kc && !vc) {
        children.push({ path: i, name: kv, value: vv });
      } else {
        children.push({
          path: i,
          name: '{ key, value }',
          children: [{ path: 'key', name: 'key', value: kv, children: kc }, { path: 'value', name: 'value', value: vv, children: vc }]
        });
      }
    }

    var diff = variable.len - variable.children.length / 2;
    if (diff > 0) {
      children.push({ path: 'more', name: '... +' + diff + ' more' });
    }

    return {
      value: shortType(variable.type),
      children: children
    };
  },
  func: function func(variable) {
    return {
      value: variable.value ? shortType(variable.value) : nil()
    };
  },
  complex: function complex(variable) {
    var _factory$variable7 = factory.variable(variable.children[0]);

    var v0 = _factory$variable7.value;

    var _factory$variable8 = factory.variable(variable.children[1]);

    var v1 = _factory$variable8.value;

    return { value: ['(', v0, v1, 'i)'] };
  },
  'default': function _default(variable) {
    var kind = KINDS[variable.kind];
    var className = undefined;
    if (variable.value) {
      if (kind.match(NUMERIC_REGEX)) {
        className = 'constant numeric';
      } else if (kind === 'bool') {
        className = 'constant language';
      }
    }
    return {
      value: { className: className, value: variable.value || '(unknown ' + KINDS[variable.kind] + ')' }
    };
  }
};

var NUMERIC_REGEX = /^(u)?(int|float)/;
var KINDS = ['invalid', 'bool', 'int', 'int8', 'int16', 'int32', 'int64', 'uint', 'uint8', 'uint16', 'uint32', 'uint64', 'uintptr', 'float32', 'float64', 'complex64', 'complex128', 'array', 'chan', 'func', 'interface', 'map', 'ptr', 'slice', 'string', 'struct', 'unsafePointer'
// total: 27...
];

function shortType(type) {
  if (!type) {
    return '';
  }
  if (type.startsWith('map[')) {
    // does not work maps with maps:
    // map[map[int]string]float32
    // map[float32]map[int]string
    // map[map[int]string]map[float32]string
    var parts = type.split(']');
    return ['map[', shortType(parts[0].substr(4)), ']', shortType(parts[1])];
  }
  if (type.startsWith('struct ')) {
    type = type.substr('struct '.length);
  }
  var t = '';
  if (type.startsWith('[')) {
    var closingIndex = type.indexOf(']');
    if (closingIndex >= 0) {
      closingIndex++;
      t = type.substring(0, closingIndex);
      type = type.substring(closingIndex);
    }
  }
  if (type.startsWith('*')) {
    t += '*';
    type = type.substring(1);
  }
  t += type.split('/').pop();
  return t;
}
function nil() {
  return { value: ' nil', className: 'constant language' };
}
function formatNumber(value) {
  return { value: value, className: 'constant numeric' };
}
function formatAddr(variable) {
  return formatNumber('0x' + variable.addr.toString(16));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zc3VuLy5hdG9tL3BhY2thZ2VzL2dvLWRlYnVnL2xpYi9kZWx2ZS12YXJpYWJsZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsV0FBVyxDQUFBOzs7Ozs7Ozs7QUFJSixTQUFTLE1BQU0sQ0FBRSxZQUFZLEVBQUU7QUFDcEMsTUFBTSxTQUFTLEdBQUcsRUFBRSxDQUFBOztBQUVwQixXQUFTLFdBQVcsQ0FBRSxVQUFVLEVBQUUsUUFBUSxFQUFFO0FBQzFDLFFBQU0sSUFBSSxHQUFHLFFBQVEsQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFBO1FBQ3hDLFFBQVEsR0FBSyxRQUFRLENBQXJCLFFBQVE7O0FBQ2hCLGFBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRztBQUNoQixVQUFJLEVBQUUsUUFBUSxDQUFDLElBQUk7QUFDbkIsWUFBTSxFQUFFLElBQUk7QUFDWixpQkFBVyxFQUFFLFFBQVEsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxLQUFLO0FBQ2pELFdBQUssRUFBRSxRQUFRLENBQUMsS0FBSztBQUNyQixnQkFBVSxFQUFWLFVBQVU7S0FDWCxDQUFBO0FBQ0QsUUFBSSxRQUFRLEVBQUU7QUFDWixjQUFRLENBQUMsT0FBTyxDQUFDLFVBQUMsQ0FBQyxFQUFLO0FBQ3RCLG1CQUFXLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFBO09BQ3JCLENBQUMsQ0FBQTtLQUNIO0dBQ0Y7O0FBRUQsY0FBWSxDQUFDLEdBQUcsQ0FBQyxVQUFDLFFBQVEsRUFBSztBQUM3QixRQUFNLENBQUMsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFBO0FBQ3BDLEtBQUMsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFBO0FBQy9CLGVBQVcsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUE7R0FDbkIsQ0FBQyxDQUFBOztBQUVGLFNBQU8s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QUFMLEtBQUssRUFBRSxTQUFTLEVBQUUsa0JBQWtCLEVBQUUsQ0FBQTtDQUFFO0FBQ2pGLFNBQVMsVUFBVSxDQUFFLFFBQVEsRUFBRTtBQUFFLFNBQU8sWUFBWSxDQUFDLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFBO0NBQUUiLCJmaWxlIjoiL1VzZXJzL3NzdW4vLmF0b20vcGFja2FnZXMvZ28tZGVidWcvbGliL2RlbHZlLXZhcmlhYmxlcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnXG5cbi8qIGVzbGludC1kaXNhYmxlIG5vLXVzZS1iZWZvcmUtZGVmaW5lICovXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGUgKHJhd1ZhcmlhYmxlcykge1xuICBjb25zdCB2YXJpYWJsZXMgPSB7fVxuXG4gIGZ1bmN0aW9uIGFkZFZhcmlhYmxlIChwYXJlbnRQYXRoLCB2YXJpYWJsZSkge1xuICAgIGNvbnN0IHBhdGggPSBwYXRoSm9pbihwYXJlbnRQYXRoLCB2YXJpYWJsZS5wYXRoKVxuICAgIGNvbnN0IHsgY2hpbGRyZW4gfSA9IHZhcmlhYmxlXG4gICAgdmFyaWFibGVzW3BhdGhdID0ge1xuICAgICAgbmFtZTogdmFyaWFibGUubmFtZSxcbiAgICAgIGxvYWRlZDogdHJ1ZSxcbiAgICAgIGhhc0NoaWxkcmVuOiBjaGlsZHJlbiA/ICEhY2hpbGRyZW4ubGVuZ3RoIDogZmFsc2UsXG4gICAgICB2YWx1ZTogdmFyaWFibGUudmFsdWUsXG4gICAgICBwYXJlbnRQYXRoXG4gICAgfVxuICAgIGlmIChjaGlsZHJlbikge1xuICAgICAgY2hpbGRyZW4uZm9yRWFjaCgodikgPT4ge1xuICAgICAgICBhZGRWYXJpYWJsZShwYXRoLCB2KVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICByYXdWYXJpYWJsZXMubWFwKCh2YXJpYWJsZSkgPT4ge1xuICAgIGNvbnN0IHYgPSBmYWN0b3J5LnZhcmlhYmxlKHZhcmlhYmxlKVxuICAgIHYucGF0aCA9IHYubmFtZSA9IHZhcmlhYmxlLm5hbWVcbiAgICBhZGRWYXJpYWJsZSgnJywgdilcbiAgfSlcblxuICByZXR1cm4gdmFyaWFibGVzXG59XG5cbmZ1bmN0aW9uIHBhdGhKb2luICguLi5pdGVtcykge1xuICByZXR1cm4gaXRlbXMuZmlsdGVyKChpKSA9PiBpICE9PSAnJykuam9pbignLicpXG59XG5cbmNvbnN0IGZhY3RvcnkgPSB7XG4gIHZhcmlhYmxlICh2YXJpYWJsZSkge1xuICAgIGlmICh2YXJpYWJsZS51bnJlYWRhYmxlICE9PSAnJykge1xuICAgICAgcmV0dXJuIHsgdmFsdWU6IGAodW5yZWFkYWJsZSAke3ZhcmlhYmxlLnVucmVhZGFibGV9KWAgfVxuICAgIH1cblxuICAgIGlmICghdmFyaWFibGUudmFsdWUgJiYgdmFyaWFibGUuYWRkciA9PT0gMCkge1xuICAgICAgcmV0dXJuIHsgdmFsdWU6IFtzaG9ydFR5cGUodmFyaWFibGUudHlwZSksIG5pbCgpXSB9XG4gICAgfVxuXG4gICAgbGV0IGZuID0gS0lORFNbdmFyaWFibGUua2luZF1cbiAgICBpZiAoZm4uc3RhcnRzV2l0aCgnY29tcGxleCcpKSB7XG4gICAgICBmbiA9ICdjb21wbGV4J1xuICAgIH0gZWxzZSBpZiAoIWZhY3RvcnlbZm5dKSB7XG4gICAgICBmbiA9ICdkZWZhdWx0J1xuICAgIH1cbiAgICByZXR1cm4gZmFjdG9yeVtmbl0odmFyaWFibGUpXG4gIH0sXG4gIGFycmF5ICh2YXJpYWJsZSkge1xuICAgIHJldHVybiBmYWN0b3J5LnNsaWNlKHZhcmlhYmxlKVxuICB9LFxuICBzbGljZSAodmFyaWFibGUpIHtcbiAgICBjb25zdCBjaGlsZHJlbiA9IHZhcmlhYmxlLmNoaWxkcmVuLm1hcCgoYywgaSkgPT4ge1xuICAgICAgY29uc3QgeyB2YWx1ZSwgY2hpbGRyZW4gfSA9IGZhY3RvcnkudmFyaWFibGUoYylcbiAgICAgIHJldHVybiB7IHBhdGg6IGksIG5hbWU6IGZvcm1hdE51bWJlcihpKSwgdmFsdWUsIGNoaWxkcmVuIH1cbiAgICB9KVxuXG4gICAgY29uc3QgZGlmZiA9IHZhcmlhYmxlLmxlbiAtIHZhcmlhYmxlLmNoaWxkcmVuLmxlbmd0aFxuICAgIGlmIChkaWZmID4gMCkge1xuICAgICAgY2hpbGRyZW4ucHVzaCh7IHBhdGg6ICdtb3JlJywgbmFtZTogYC4uLiArJHtkaWZmfSBtb3JlYCB9KVxuICAgIH1cblxuICAgIGNvbnN0IGtpbmQgPSBLSU5EU1t2YXJpYWJsZS5raW5kXVxuICAgIGNvbnN0IHR5cGVJbmZvID0ga2luZCA9PT0gJ3NsaWNlJyAmJiBbJyhsZW46ICcsIGZvcm1hdE51bWJlcih2YXJpYWJsZS5sZW4pLCAnLCBjYXA6ICcsIGZvcm1hdE51bWJlcih2YXJpYWJsZS5jYXApLCAnKSddXG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbHVlOiBbc2hvcnRUeXBlKHZhcmlhYmxlLnR5cGUpLCB0eXBlSW5mb10sXG4gICAgICBjaGlsZHJlblxuICAgIH1cbiAgfSxcbiAgcHRyICh2YXJpYWJsZSkge1xuICAgIGNvbnN0IGNoaWxkID0gdmFyaWFibGUuY2hpbGRyZW5bMF1cbiAgICBpZiAodmFyaWFibGUudHlwZSA9PT0gJycpIHtcbiAgICAgIHJldHVybiB7IHZhbHVlOiBuaWwoKSB9XG4gICAgfVxuXG4gICAgaWYgKGNoaWxkLm9ubHlBZGRyKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogWycoJywgc2hvcnRUeXBlKHZhcmlhYmxlLnR5cGUpLCAnKSgnLCBmb3JtYXRBZGRyKGNoaWxkKSwgJyknXVxuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCB7IHZhbHVlLCBjaGlsZHJlbiB9ID0gZmFjdG9yeS52YXJpYWJsZShjaGlsZClcbiAgICByZXR1cm4ge1xuICAgICAgdmFsdWU6IFsnKicsIHZhbHVlXSxcbiAgICAgIGNoaWxkcmVuXG4gICAgfVxuICB9LFxuICB1bnNhZmVQb2ludGVyICh2YXJpYWJsZSkge1xuICAgIHJldHVybiB7XG4gICAgICB2YWx1ZTogWyd1bnNhZmUuUG9pbnRlcignLCBmb3JtYXRBZGRyKHZhcmlhYmxlLmNoaWxkcmVuWzBdKSwgJyknXVxuICAgIH1cbiAgfSxcbiAgc3RyaW5nICh2YXJpYWJsZSkge1xuICAgIGNvbnN0IGRpZmYgPSB2YXJpYWJsZS5sZW4gLSB2YXJpYWJsZS52YWx1ZS5sZW5ndGhcbiAgICByZXR1cm4ge1xuICAgICAgdmFsdWU6IHtcbiAgICAgICAgY2xhc3NOYW1lOiAnc3RyaW5nJyxcbiAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAnXCInICsgdmFyaWFibGUudmFsdWUgKyAnXCInLFxuICAgICAgICAgIGRpZmYgPiAwICYmIGAuLi4gKyR7ZGlmZn0gbW9yZWBcbiAgICAgICAgXVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgY2hhbiAodmFyaWFibGUpIHtcbiAgICAvLyBjb3VsZCBhbHNvIGJlIHJlbmRlcmVkIGFzIHN0cnVjdFxuICAgIC8vIHJldHVybiBmYWN0b3J5LnN0cnVjdCh2YXJpYWJsZSlcblxuICAgIGxldCBjb250ZW50XG4gICAgaWYgKHZhcmlhYmxlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29udGVudCA9IG5pbCgpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGMwID0gZmFjdG9yeS52YXJpYWJsZSh2YXJpYWJsZS5jaGlsZHJlblswXSlcbiAgICAgIGNvbnN0IGMxID0gZmFjdG9yeS52YXJpYWJsZSh2YXJpYWJsZS5jaGlsZHJlblsxXSlcbiAgICAgIGlmIChjMC5jaGlsZHJlbikge1xuICAgICAgICBjb25zb2xlLmxvZyh2YXJpYWJsZS5jaGlsZHJlblswXSlcbiAgICAgIH1cbiAgICAgIGlmIChjMS5jaGlsZHJlbikge1xuICAgICAgICBjb25zb2xlLmxvZyh2YXJpYWJsZS5jaGlsZHJlblsxXSlcbiAgICAgIH1cbiAgICAgIGNvbnRlbnQgPSBbYzAudmFsdWUsICcvJywgYzEudmFsdWVdXG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB2YWx1ZTogW3Nob3J0VHlwZSh2YXJpYWJsZS50eXBlKSwgY29udGVudF1cbiAgICB9XG4gIH0sXG4gIHN0cnVjdCAodmFyaWFibGUpIHtcbiAgICBjb25zdCB0eXBlID0gc2hvcnRUeXBlKHZhcmlhYmxlLnR5cGUpXG4gICAgY29uc3QgZGlmZiA9IHZhcmlhYmxlLmxlbiAtIHZhcmlhYmxlLmNoaWxkcmVuLmxlbmd0aFxuICAgIGlmIChkaWZmID4gMCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICB0eXBlICYmIFsnKConLCB0eXBlLCAnKSddLFxuICAgICAgICAgICcoJywgZm9ybWF0QWRkcih2YXJpYWJsZSksICcpJ1xuICAgICAgICBdXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgY2hpbGRyZW4gPSB2YXJpYWJsZS5jaGlsZHJlbi5tYXAoKGMpID0+IHtcbiAgICAgIGNvbnN0IHsgdmFsdWUsIGNoaWxkcmVuIH0gPSBmYWN0b3J5LnZhcmlhYmxlKGMpXG4gICAgICByZXR1cm4geyBwYXRoOiBjLm5hbWUsIG5hbWU6IGMubmFtZSwgdmFsdWUsIGNoaWxkcmVuIH1cbiAgICB9KVxuICAgIHJldHVybiB7XG4gICAgICB2YWx1ZTogdHlwZSxcbiAgICAgIGNoaWxkcmVuXG4gICAgfVxuICB9LFxuICBpbnRlcmZhY2UgKHZhcmlhYmxlKSB7XG4gICAgY29uc3QgY2hpbGQgPSB2YXJpYWJsZS5jaGlsZHJlblswXVxuICAgIGlmIChjaGlsZC5raW5kID09PSAwICYmIGNoaWxkLmFkZHIgPT09IDApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiBbc2hvcnRUeXBlKHZhcmlhYmxlLnR5cGUpLCBuaWwoKV1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBuaWNlciBoYW5kbGluZyBmb3IgZXJyb3JzXG4gICAgaWYgKHZhcmlhYmxlLnR5cGUgPT09ICdlcnJvcicgJiYgY2hpbGQudHlwZSA9PT0gJypzdHJ1Y3QgZXJyb3JzLmVycm9yU3RyaW5nJykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAnZXJyb3IgJyxcbiAgICAgICAgICBmYWN0b3J5LnZhcmlhYmxlKGNoaWxkLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdKS52YWx1ZVxuICAgICAgICBdXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgeyB2YWx1ZSwgY2hpbGRyZW4gfSA9IGZhY3RvcnkudmFyaWFibGUoY2hpbGQpXG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbHVlOiBbc2hvcnRUeXBlKHZhcmlhYmxlLnR5cGUpLCAnICgnLCB2YWx1ZSwgJyknXSxcbiAgICAgIGNoaWxkcmVuXG4gICAgfVxuICB9LFxuICBtYXAgKHZhcmlhYmxlKSB7XG4gICAgY29uc3QgY2hpbGRyZW4gPSBbXVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFyaWFibGUuY2hpbGRyZW4ubGVuZ3RoOyBpICs9IDIpIHtcbiAgICAgIGNvbnN0IHsgdmFsdWU6IGt2LCBjaGlsZHJlbjoga2MgfSA9IGZhY3RvcnkudmFyaWFibGUodmFyaWFibGUuY2hpbGRyZW5baV0pXG4gICAgICBjb25zdCB7IHZhbHVlOiB2diwgY2hpbGRyZW46IHZjIH0gPSBmYWN0b3J5LnZhcmlhYmxlKHZhcmlhYmxlLmNoaWxkcmVuW2kgKyAxXSlcbiAgICAgIGlmICgha2MgJiYgIXZjKSB7XG4gICAgICAgIGNoaWxkcmVuLnB1c2goeyBwYXRoOiBpLCBuYW1lOiBrdiwgdmFsdWU6IHZ2IH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjaGlsZHJlbi5wdXNoKHtcbiAgICAgICAgICBwYXRoOiBpLFxuICAgICAgICAgIG5hbWU6ICd7IGtleSwgdmFsdWUgfScsXG4gICAgICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgICAgIHsgcGF0aDogJ2tleScsIG5hbWU6ICdrZXknLCB2YWx1ZToga3YsIGNoaWxkcmVuOiBrYyB9LFxuICAgICAgICAgICAgeyBwYXRoOiAndmFsdWUnLCBuYW1lOiAndmFsdWUnLCB2YWx1ZTogdnYsIGNoaWxkcmVuOiB2YyB9XG4gICAgICAgICAgXVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGRpZmYgPSB2YXJpYWJsZS5sZW4gLSB2YXJpYWJsZS5jaGlsZHJlbi5sZW5ndGggLyAyXG4gICAgaWYgKGRpZmYgPiAwKSB7XG4gICAgICBjaGlsZHJlbi5wdXNoKHsgcGF0aDogJ21vcmUnLCBuYW1lOiBgLi4uICske2RpZmZ9IG1vcmVgIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbHVlOiBzaG9ydFR5cGUodmFyaWFibGUudHlwZSksXG4gICAgICBjaGlsZHJlbjogY2hpbGRyZW5cbiAgICB9XG4gIH0sXG4gIGZ1bmMgKHZhcmlhYmxlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbHVlOiB2YXJpYWJsZS52YWx1ZSA/IHNob3J0VHlwZSh2YXJpYWJsZS52YWx1ZSkgOiBuaWwoKVxuICAgIH1cbiAgfSxcbiAgY29tcGxleCAodmFyaWFibGUpIHtcbiAgICBjb25zdCB7IHZhbHVlOiB2MCB9ID0gZmFjdG9yeS52YXJpYWJsZSh2YXJpYWJsZS5jaGlsZHJlblswXSlcbiAgICBjb25zdCB7IHZhbHVlOiB2MSB9ID0gZmFjdG9yeS52YXJpYWJsZSh2YXJpYWJsZS5jaGlsZHJlblsxXSlcbiAgICByZXR1cm4geyB2YWx1ZTogWycoJywgdjAsIHYxLCAnaSknXSB9XG4gIH0sXG4gIGRlZmF1bHQgKHZhcmlhYmxlKSB7XG4gICAgY29uc3Qga2luZCA9IEtJTkRTW3ZhcmlhYmxlLmtpbmRdXG4gICAgbGV0IGNsYXNzTmFtZVxuICAgIGlmICh2YXJpYWJsZS52YWx1ZSkge1xuICAgICAgaWYgKGtpbmQubWF0Y2goTlVNRVJJQ19SRUdFWCkpIHtcbiAgICAgICAgY2xhc3NOYW1lID0gJ2NvbnN0YW50IG51bWVyaWMnXG4gICAgICB9IGVsc2UgaWYgKGtpbmQgPT09ICdib29sJykge1xuICAgICAgICBjbGFzc05hbWUgPSAnY29uc3RhbnQgbGFuZ3VhZ2UnXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB2YWx1ZTogeyBjbGFzc05hbWUsIHZhbHVlOiB2YXJpYWJsZS52YWx1ZSB8fCAnKHVua25vd24gJyArIEtJTkRTW3ZhcmlhYmxlLmtpbmRdICsgJyknIH1cbiAgICB9XG4gIH1cbn1cblxuY29uc3QgTlVNRVJJQ19SRUdFWCA9IC9eKHUpPyhpbnR8ZmxvYXQpL1xuY29uc3QgS0lORFMgPSBbXG4gICdpbnZhbGlkJyxcbiAgJ2Jvb2wnLFxuICAnaW50JyxcbiAgJ2ludDgnLFxuICAnaW50MTYnLFxuICAnaW50MzInLFxuICAnaW50NjQnLFxuICAndWludCcsXG4gICd1aW50OCcsXG4gICd1aW50MTYnLFxuICAndWludDMyJyxcbiAgJ3VpbnQ2NCcsXG4gICd1aW50cHRyJyxcbiAgJ2Zsb2F0MzInLFxuICAnZmxvYXQ2NCcsXG4gICdjb21wbGV4NjQnLFxuICAnY29tcGxleDEyOCcsXG4gICdhcnJheScsXG4gICdjaGFuJyxcbiAgJ2Z1bmMnLFxuICAnaW50ZXJmYWNlJyxcbiAgJ21hcCcsXG4gICdwdHInLFxuICAnc2xpY2UnLFxuICAnc3RyaW5nJyxcbiAgJ3N0cnVjdCcsXG4gICd1bnNhZmVQb2ludGVyJ1xuICAvLyB0b3RhbDogMjcuLi5cbl1cblxuZnVuY3Rpb24gc2hvcnRUeXBlICh0eXBlKSB7XG4gIGlmICghdHlwZSkge1xuICAgIHJldHVybiAnJ1xuICB9XG4gIGlmICh0eXBlLnN0YXJ0c1dpdGgoJ21hcFsnKSkge1xuICAgIC8vIGRvZXMgbm90IHdvcmsgbWFwcyB3aXRoIG1hcHM6XG4gICAgLy8gbWFwW21hcFtpbnRdc3RyaW5nXWZsb2F0MzJcbiAgICAvLyBtYXBbZmxvYXQzMl1tYXBbaW50XXN0cmluZ1xuICAgIC8vIG1hcFttYXBbaW50XXN0cmluZ11tYXBbZmxvYXQzMl1zdHJpbmdcbiAgICBjb25zdCBwYXJ0cyA9IHR5cGUuc3BsaXQoJ10nKVxuICAgIHJldHVybiBbJ21hcFsnLCBzaG9ydFR5cGUocGFydHNbMF0uc3Vic3RyKDQpKSwgJ10nLCBzaG9ydFR5cGUocGFydHNbMV0pXVxuICB9XG4gIGlmICh0eXBlLnN0YXJ0c1dpdGgoJ3N0cnVjdCAnKSkge1xuICAgIHR5cGUgPSB0eXBlLnN1YnN0cignc3RydWN0ICcubGVuZ3RoKVxuICB9XG4gIGxldCB0ID0gJydcbiAgaWYgKHR5cGUuc3RhcnRzV2l0aCgnWycpKSB7XG4gICAgbGV0IGNsb3NpbmdJbmRleCA9IHR5cGUuaW5kZXhPZignXScpXG4gICAgaWYgKGNsb3NpbmdJbmRleCA+PSAwKSB7XG4gICAgICBjbG9zaW5nSW5kZXgrK1xuICAgICAgdCA9IHR5cGUuc3Vic3RyaW5nKDAsIGNsb3NpbmdJbmRleClcbiAgICAgIHR5cGUgPSB0eXBlLnN1YnN0cmluZyhjbG9zaW5nSW5kZXgpXG4gICAgfVxuICB9XG4gIGlmICh0eXBlLnN0YXJ0c1dpdGgoJyonKSkge1xuICAgIHQgKz0gJyonXG4gICAgdHlwZSA9IHR5cGUuc3Vic3RyaW5nKDEpXG4gIH1cbiAgdCArPSB0eXBlLnNwbGl0KCcvJykucG9wKClcbiAgcmV0dXJuIHRcbn1cbmZ1bmN0aW9uIG5pbCAoKSB7IHJldHVybiB7IHZhbHVlOiAnIG5pbCcsIGNsYXNzTmFtZTogJ2NvbnN0YW50IGxhbmd1YWdlJyB9IH1cbmZ1bmN0aW9uIGZvcm1hdE51bWJlciAodmFsdWUpIHsgcmV0dXJuIHsgdmFsdWUsIGNsYXNzTmFtZTogJ2NvbnN0YW50IG51bWVyaWMnIH0gfVxuZnVuY3Rpb24gZm9ybWF0QWRkciAodmFyaWFibGUpIHsgcmV0dXJuIGZvcm1hdE51bWJlcignMHgnICsgdmFyaWFibGUuYWRkci50b1N0cmluZygxNikpIH1cbiJdfQ==
//# sourceURL=/Users/ssun/.atom/packages/go-debug/lib/delve-variables.js
